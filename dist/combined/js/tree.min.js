"undefined"==typeof gj&&(gj={}),"undefined"==typeof gj.tree&&(gj.tree={plugins:{}}),gj.tree.config={base:{autoLoad:!0,selectionType:"single",cascadeSelection:!1,dataSource:void 0,primaryKey:void 0,textField:"text",childrenField:"children",width:void 0,uiLibrary:"base",autoGenId:1,style:{wrapper:"gj-tree-unselectable",list:"gj-tree-list",item:"gj-tree-item",active:"gj-tree-base-active",leftSpacer:void 0,expander:"gj-tree-expander",display:"gj-tree-display",expandIcon:void 0,collapseIcon:void 0,leafIcon:void 0}},bootstrap:{style:{wrapper:"gj-tree-unselectable",list:"gj-bootstrap-tree-list list-group",item:"gj-bootstrap-tree-item list-group-item",active:"active",leftSpacer:"gj-tree-bootstrap-left-spacer",expander:"gj-tree-bootstrap-expander glyphicon",display:"gj-tree-bootstrap-display",expandIcon:"glyphicon-plus",collapseIcon:"glyphicon-minus",leafIcon:void 0}},jqueryui:{}},gj.tree.events={initialized:function(a){a.triggerHandler("initialized")},dataBinding:function(a){a.triggerHandler("dataBinding")},dataBound:function(a){a.triggerHandler("dataBound")},select:function(a,b,c,d){return a.triggerHandler("select",[b,c,d])},unselect:function(a,b,c,d){return a.triggerHandler("unselect",[b,c,d])},expand:function(a,b,c,d){return a.triggerHandler("expand",[b,c,d])},collapse:function(a,b,c,d){return a.triggerHandler("collapse",[b,c,d])},destroying:function(a){return a.triggerHandler("destroying")}},gj.tree.methods={init:function(a){return gj.widget.prototype.init.call(this,a,"tree"),gj.tree.methods.initialize.call(this),this.data("autoLoad")&&this.reload(),this},initialize:function(){var a=this.data(),b=$('<ul class="'+a.style.list+'"/>');this.empty().addClass(a.style.wrapper).append(b),a.width&&this.width(a.width),gj.tree.events.initialized(this)},render:function(a,b){return b&&("string"==typeof b&&JSON&&(b=JSON.parse(b)),a.data("records",gj.tree.methods.getRecords(a,b)),gj.tree.methods.loadData(a)),a},getRecords:function(a,b){var c,d,e,f=[],g=a.data();for(c=0;c<b.length;c++)d=g.primaryKey?b[c][g.primaryKey]:g.autoGenId++,e={id:d,data:b[c]},b[c][g.childrenField]&&b[c][g.childrenField].length&&(e.children=gj.tree.methods.getRecords(a,b[c][g.childrenField]),delete b[c][g.childrenField]),f.push(e);return f},loadData:function(a){var b,c=a.data("records"),d=a.children("ul");for(gj.tree.events.dataBinding(a),d.off().empty(),b=0;b<c.length;b++)gj.tree.methods.appendNode(a,d,c[b],1);gj.tree.events.dataBound(a)},appendNode:function(a,b,c,d,e){var f,g,h,i=a.data(),g=$('<li data-id="'+c.id+'"/>').addClass(i.style.item),j=$('<span data-role="expander" data-mode="close"></span>'),k=$('<span data-role="display">'+c.data[i.textField]+"</span>");if(i.style.leftSpacer)for(d||(d=b.parents("ul").length+1),f=1;d>f;f++)g.append('<span data-role="spacer" class="'+i.style.leftSpacer+'"></span>');if(j.addClass(i.style.expander).on("click",gj.tree.methods.expanderClickHandler(a)),g.append(j),k.addClass(i.style.display).on("click",gj.tree.methods.displayClickHandler(a)),g.append(k),c.children&&c.children.length)for(i.style.expandIcon?j.addClass(i.style.expandIcon):j.text("+"),h=$("<ul />").addClass(i.style.list).addClass("gj-hidden"),g.append(h),f=0;f<c.children.length;f++)gj.tree.methods.appendNode(a,h,c.children[f],d+1);else i.style.leafIcon?j.addClass(i.style.leafIcon):j.html("&nbsp;");e?b.find("li:eq("+(e-1)+")").before(g):b.append(g)},expanderClickHandler:function(a){return function(b){var c=$(this),d=c.parent("li");"close"===c.attr("data-mode")?a.expand(d):a.collapse(d)}},expand:function(a,b,c){var d,e,f=b.children('[data-role="expander"]'),g=a.data(),h=b.attr("data-id"),i=b.children("ul");if(i&&i.length&&gj.tree.events.expand(a,b,h)!==!1&&(i.show(),f.attr("data-mode","open"),g.style.collapseIcon?f.removeClass(g.style.expandIcon).addClass(g.style.collapseIcon):f.text("-"),c))for(d=b.find("ul>li"),e=0;e<d.length;e++)gj.tree.methods.expand(a,$(d[e]),c);return a},collapse:function(a,b,c){var d,e,f=b.children('[data-role="expander"]'),g=a.data(),h=b.attr("data-id"),i=b.children("ul");if(i&&i.length&&gj.tree.events.collapse(a,b,h)!==!1&&(i.hide(),f.attr("data-mode","close"),g.style.expandIcon?f.removeClass(g.style.collapseIcon).addClass(g.style.expandIcon):f.text("+"),c))for(d=b.find("ul>li"),e=0;e<d.length;e++)gj.tree.methods.collapse(a,$(d[e]),c);return a},expandAll:function(a){var b,c=a.find("ul>li");for(b=0;b<c.length;b++)gj.tree.methods.expand(a,$(c[b]),!0);return a},collapseAll:function(a){var b,c=a.find("ul>li");for(b=0;b<c.length;b++)gj.tree.methods.collapse(a,$(c[b]),!0);return a},displayClickHandler:function(a){return function(b){var c=$(this),d=c.parent("li"),e=a.data().cascadeSelection;"true"===d.attr("data-selected")?gj.tree.methods.unselect(a,d,e):("single"===a.data("selectionType")&&gj.tree.methods.unselectAll(a),gj.tree.methods.select(a,d,e))}},selectAll:function(a){var b,c=a.find("ul>li");for(b=0;b<c.length;b++)gj.tree.methods.select(a,$(c[b]),!0);return a},select:function(a,b,c){var d,e,f=a.data();if("true"!==b.attr("data-selected")&&gj.tree.events.select(a,b)!==!1&&(b.addClass(f.style.active).attr("data-selected","true"),c))for(e=b.find("ul>li"),d=0;d<e.length;d++)gj.tree.methods.select(a,$(e[d]),c)},unselectAll:function(a){var b,c=a.find("ul>li");for(b=0;b<c.length;b++)gj.tree.methods.unselect(a,$(c[b]),!0);return a},unselect:function(a,b,c){var d,e;a.data();if("true"===b.attr("data-selected")&&gj.tree.events.unselect(a,b)!==!1&&(b.removeClass(a.data().style.active).removeAttr("data-selected"),c))for(e=b.find("ul li"),d=0;d<e.length;d++)gj.tree.methods.unselect(a,$(e[d]),c)},getSelections:function(a){var b,c,d,e=[],f=a.children("li");if(f&&f.length)for(b=0;b<f.length;b++)c=$(f[b]),"true"===c.attr("data-selected")?e.push(c.attr("data-id")):c.has("ul")&&(d=gj.tree.methods.getSelections(c.children("ul")),d.length&&(e=e.concat(d)));return e},getById:function(a,b,c){var d,e=void 0;for(d=0;d<c.length;d++){if(b==c[d].id){e=c[d];break}if(c[d].children&&c[d].children.length&&(e=gj.tree.methods.getById(a,b,c[d].children)))break}return e},getDataById:function(a,b,c){var d=gj.tree.methods.getById(a,b,c);return d?d.data:d},getDataByText:function(a,b,c){var d,e=void 0,f=a.data();for(d=0;d<c.length;d++){if(b===c[d].data[f.textField]){e=c[d].data;break}if(c[d].children&&c[d].children.length&&(e=gj.tree.methods.getDataByText(a,b,c[d].children)))break}return e},getNodeById:function(a,b){var c,d,e=void 0,f=a.children("li");if(f&&f.length)for(c=0;c<f.length;c++){if(d=$(f[c]),b==d.attr("data-id")){e=d;break}if(d.has("ul")&&(e=gj.tree.methods.getNodeById(d.children("ul"),b)))break}return e},getNodeByText:function(a,b){var c,d,e=void 0,f=a.children("li");if(f&&f.length)for(c=0;c<f.length;c++){if(d=$(f[c]),b===d.children('[data-role="display"]').text()){e=d;break}if(d.has("ul")&&(e=gj.tree.methods.getNodeByText(d.children("ul"),b)))break}return e},addNode:function(a,b,c,d){var e=gj.tree.methods.getRecords(a,[b]);return c&&c.length||(c=a.children("ul")),gj.tree.methods.appendNode(a,c,e[0],void 0,d),a},remove:function(a,b){return gj.tree.methods.removeDataById(a,b.attr("data-id"),a.data("records")),b.remove(),a},removeDataById:function(a,b,c){var d;for(d=0;d<c.length;d++){if(b==c[d].id){c.splice(d,1);break}c[d].children&&c[d].children.length&&gj.tree.methods.removeDataById(a,b,c[d].children)}},destroy:function(a){var b=a.data();return b&&(gj.tree.events.destroying(a),a.xhr&&a.xhr.abort(),a.off(),a.removeData(),a.attr("data-tree",!1),a.removeClass().empty()),a}},gj.tree.widget=function(a,arguments){var b=this,c=gj.tree.methods;return b.reload=function(a){return gj.widget.prototype.reload.call(this,a)},b.render=function(a){return c.render(this,a)},b.addNode=function(a,b,d){return c.addNode(this,a,b,d)},b.removeNode=function(a){return c.remove(this,a)},b.destroy=function(){return c.destroy(this)},b.expand=function(a,b){return c.expand(this,a,b)},b.collapse=function(a,b){return c.collapse(this,a,b)},b.expandAll=function(){return c.expandAll(this)},b.collapseAll=function(){return c.collapseAll(this)},b.getDataById=function(a){return c.getDataById(this,a,this.data("records"))},b.getDataByText=function(a){return c.getDataByText(this,a,this.data("records"))},b.getNodeById=function(a){return c.getNodeById(this.children("ul"),a)},b.getNodeByText=function(a){return c.getNodeByText(this.children("ul"),a)},b.selectAll=function(){return c.selectAll(this)},b.unselectAll=function(){return c.unselectAll(this)},b.getSelections=function(){return c.getSelections(this.children("ul"))},$.extend(a,b),"true"!==a.attr("data-tree")&&c.init.apply(a,arguments),a},gj.tree.widget.prototype=new gj.widget,gj.tree.widget.constructor=gj.tree.widget,function(a){a.fn.tree=function(a){var b;if("object"!=typeof a&&a){if(b=new gj.tree.widget(this,null),b[a])return b[a].apply(this,Array.prototype.slice.call(arguments,1));throw"Method "+a+" does not exist."}return new gj.tree.widget(this,arguments)}}(jQuery);